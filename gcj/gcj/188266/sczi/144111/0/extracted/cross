#!/usr/bin/perl -w

use List::Util qw/min/;

$C=<>;
for (1..$C) {
    ($N,$M)=split / /,<>;
    for $i (0..$N-1) {
        $j=0;
        for (<>=~m/\d+ \d+ \d+/g) {
            ($S->[$i]->[$j],$W->[$i]->[$j],$T->[$i]->[$j])=split / /;
            $T->[$i]->[$j]%=$S->[$i]->[$j]+$W->[$i]->[$j];
            $j++;
        }
    }
    for $i (0..2*$N-1) {
        for $j (0..2*$M-1) {
            if($i==0 and $j==0) {
                $dp->[$i]->[$j]=0;
            } else {
                $dp->[$i]->[$j]=99999999999999;
                if($i>0) {
                    $t=$dp->[$i-1]->[$j];
                    if($i%2==1) {
                        $lightt=($t+$S->[$i/2]->[$j/2]+$W->[$i/2]->[$j/2]-$T->[$i/2]->[$j/2]) %
                        ($S->[$i/2]->[$j/2]+$W->[$i/2]->[$j/2]);
                        $t+=$S->[$i/2]->[$j/2]+$W->[$i/2]->[$j/2]-$lightt if $lightt>=$S->[$i/2]->[$j/2];
                        $dp->[$i]->[$j]=min($dp->[$i]->[$j],$t+1);
                    } else {
                        $dp->[$i]->[$j]=min($dp->[$i]->[$j],$t+2);
                    }
                }
                if($j>0) {
                    $t=$dp->[$i]->[$j-1];
                    if($j%2==1) {
                        $lightt=($t+$S->[$i/2]->[$j/2]+$W->[$i/2]->[$j/2]-$T->[$i/2]->[$j/2]) %
                            ($S->[$i/2]->[$j/2]+$W->[$i/2]->[$j/2]);
                        $t+=$S->[$i/2]->[$j/2]-$lightt if $lightt<$S->[$i/2]->[$j/2];
                        $dp->[$i]->[$j]=min($dp->[$i]->[$j],$t+1);
                    } else {
                        $dp->[$i]->[$j]=min($dp->[$i]->[$j],$t+2);
                    }
                }
            }
#            print "$i,$j: ",$dp->[$i]->[$j],"\n";
        }
    }
    print "Case #$_: ",$dp->[2*$N-1]->[2*$M-1],"\n";
}
