
#include <stdio.h>
#include <string.h>

int n;
int b[10];
int a[1001][11];
int c[1000];

void init()
{
	memset(a,1,sizeof(a));
	a[2][3]=a[4][3]=0;
	a[5][3]=0;
	a[8][3]=0;

	a[4][5]=a[16][5]=a[10][5]=0;
	a[13][5]=0;
	a[18][5]=0;

	//32  21 5 41 25 45
	a[20][6]=a[13][6]=a[5][6]=a[25][6]=a[17][6]=a[29][6]=0;
	//105 42 32
	a[37][6]=a[26][6]=0;

	//2 4 22 11 
	a[2][7]=a[4][7]=a[16][7]=a[8][7]=0;
	//34
	a[25][7]=0;
	//13
	a[10][7]=0;
	//23 16 52 41 23
	a[17][7]=a[13][7]=a[37][7]=a[29][7]=0;
	//63
	a[45][7]=0;
	//44
	a[32][7]=0;

	//4 20
	a[4][8]=a[16][8]=0;
	//5 31 12
	a[5][8]=a[25][8]=a[10][8]=0;
	//32 15
	a[26][8]=a[13][8]=0;
	//24
	a[20][8]=0;
	//64
	a[52][8]=0;

	//55
	a[50][9]=0;
	//58 108 72 58
	a[53][9]=a[89][9]=a[65][9]=0;
	//45
	a[41][9]=0;
	//75 82
	a[68][9]=a[74][9]=0;
	int i;
	for (i=0;i<=1000;i++)
	{
		a[i][10]=0;
	}

	a[1][10]=a[7][10]=a[10][10]=a[13][10]=a[19][10]=a[23][10]=1;
	a[28][10]=a[31][10]=a[32][10]=a[44][10]=a[49][10]=a[68][10]=1;
	a[70][10]=a[79][10]=a[82][10]=a[86][10]=a[91][10]=a[94][10]=1;
	a[97][10]=a[100][10]=a[103][10]=a[109][10]=a[129][10]=a[130][10]=1;
	a[133][10]=a[139][10]=a[167][10]=a[176][10]=a[188][10]=a[190][10]=1;
	a[192][10]=a[193][10]=a[203][10]=a[208][10]=a[219][10]=a[226][10]=1;
	a[230][10]=a[236][10]=a[239][10]=a[262][10]=a[263][10]=a[280][10]=1;
	a[291][10]=a[293][10]=a[301][10]=a[302][10]=a[310][10]=a[313][10]=1;
	a[319][10]=a[320][10]=a[326][10]=a[329][10]=a[331][10]=a[338][10]=1;
	a[356][10]=a[362][10]=a[365][10]=a[367][10]=a[368][10]=a[376][10]=1;
	a[379][10]=a[383][10]=a[386][10]=a[391][10]=a[392][10]=a[397][10]=1;
	a[404][10]=a[409][10]=a[440][10]=a[446][10]=a[464][10]=a[469][10]=1;
	a[478][10]=a[487][10]=a[490][10]=a[496][10]=1;
}


int isunhappy(int n,int base)
{
	if (base==2 || base==4)
	{
		return 0;
	}
	if (n<500 && a[n][base]==0)
	{
		return 1;
	}

	if (n==1)
	{
		return 0;
	}

	int i,j,k,l;
	memset(c,0,sizeof(c));
	c[0]=n;
	for (i=1;;i++ )
	{
		k=c[i-1];
		c[i]=0;
		while (k)
		{
			l=k%base;
			j=l*l;
			c[i]+=j;
			k/=base;
		}
		if (c[i]<=1000 && a[c[i]][base]==0)
		{
			for (j=0;j<i;j++)
			{
				if (c[j]<=1000)
				{
					a[c[j]][base]=0;
				}
			}
			return 1;
		}
		if (c[i]==1) return 0;
	}
	return 0;
}

int main()
{
	freopen("A-small-attempt0.in.txt","r",stdin);
//	freopen("a2.txt","r",stdin);
	freopen("a.out","w",stdout);

	init();

	int T;
	scanf("%d",&T);
	scanf("\n");
	int tt;
	char s[1000];
		
	int i,j,k,l;
	for (tt=1;tt<=T;tt++)
	{
		gets(s);		
//		printf("\n%s\n",s);

		k=strlen(s);
		int j=0;
		n=0;
		for (i=0;i<k;i++)
		{
			if (s[i]>='0' && s[i]<='9')
			{
				j=j*10+s[i]-'0';
			}
			else
			{
				b[n]=j;
///				printf("%d ",j);
				n++;
				j=0;
			}
		}
		if (j)
		{
			b[n]=j;
///			printf("%d ",j);
			n++;
		}
//		printf("\n");

		
		for (i=2;;i++)
		{
			for (j=0;j<n;j++)
			{
				if (isunhappy(i,b[j]))
				{
					break;
				}
			}
			if (j==n)
			{
				printf("Case #%d: %d\n",tt,i);
				break;
			}
		}

	}

	return 0;
}
